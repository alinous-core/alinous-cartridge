#!/bin/bash

source $OPENSHIFT_CARTRIDGE_SDK_BASH

STOPTIMEOUT=10
FMT="%a %b %d %Y %H:%M:%S GMT%z (%Z)"


function status() {
    echo "status()"
    
}


function start() {
    
    ${OPENSHIFT_ALINOUS_DIR}/bin/initdb
    
    client_message "Start tomcat and alinous server";
    
    SHELL_DIR=${OPENSHIFT_ALINOUS_DIR}tomcat/bin
    client_message "SHELL_DIR : $SHELL_DIR";
    ${SHELL_DIR}/startup.sh

   
}

function stop() {
    client_message "Stop tomcat and alinous server";
    
    
    exit 0
}

function restart() {
    stop()
    start()
}

function build() {
    client_message "building.....";
    echo
}

function post-deploy() {
    echo
}

function pre-build() {
    echo
}

function tidy() {
  client_message "Emptying log dir: $OPENSHIFT_ALINOUS_DIR/log"
  shopt -s dotglob
  rm -rf $OPENSHIFT_ALINOUS/ALINOUS_HOME/log/*
  rm -rf $OPENSHIFT_ALINOUS/ALINOUS_HOME/tmp/*
}

#
#  main():
#

# Ensure arguments.
if ! [ $# -eq 1 ]; then
    echo "Usage: $0 [start|restart|graceful|graceful-stop|stop|status]"
    exit 1
fi

# Source utility functions.
# source $OPENSHIFT_CARTRIDGE_SDK_BASH

# Handle commands.
case "$1" in
    start)               start       ;;
    restart|graceful)    restart     ;;
    graceful-stop|stop)  stop        ;;
    status)              status      ;;
    build)               build       ;;
    pre-build)           pre-build   ;;
    post-deploy)         post-deploy ;;
    tidy)                tidy        ;;
    *) exit 0;
esac

